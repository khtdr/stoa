* Project Stoa

** Project Status
*** [ ] create a malleable language framework for exploring language ideas

** Build Status
#+begin_src sh :exports both :results verbatim
make build
#+end_src

#+RESULTS:
#+begin_example
npx tsup --keep-names --no-splitting \
	         --out-dir ./bin src/stoa.ts \
	         --sourcemap
CLI Building entry: src/stoa.ts
CLI Using tsconfig: tsconfig.json
CLI tsup v6.1.2
CLI Target: node14
CJS Build start
CJS ⚡️ Build success in 84ms
CJS bin/stoa.js     162.13 KB
CJS bin/stoa.js.map 301.39 KB
#+end_example

** Usage Documentation
#+begin_src sh :exports both :results verbatim
./bin/stoa --help
#+end_src

#+RESULTS:
#+begin_example
Usage: node ./bin/stoa.js [options] [file]
Show this help message
    --help
prints version info and exits
    -v
prints parse tree and exits
    -p
prints tokens and exits
    -t

#+end_example

** Current Version
#+begin_src sh :exports both :results verbatim
./bin/stoa -v
#+end_src

#+RESULTS:
: stoa-2022.07.20

** Code Structure
#+begin_src shell :results none
make graph
#+end_src

[[./dependency-graph.png]]


** Test Suite Status

#+begin_src sh :exports both :results verbatim
make test
#+end_src

#+RESULTS:
#+begin_example
Testing tokenizer snapshots
✔ arithmetic.stoa
✔ closures.stoa
✔ divide-by-zero.stoa
✔ fib.stoa
✔ functions.stoa
✔ global-redefine.stoa
✔ hello-world.stoa
✔ literals.stoa
✔ logical-ternary.stoa
✔ name.stoa
✔ same-names.stoa
✔ scope.stoa
✔ semantic-return.stoa
✔ sticky-precision.stoa
Passing: 14 Failing: 0

Snapshotting the parse tree
✔ arithmetic.stoa
✔ closures.stoa
✔ divide-by-zero.stoa
✔ fib.stoa
✔ functions.stoa
✔ global-redefine.stoa
✔ hello-world.stoa
✔ literals.stoa
✔ logical-ternary.stoa
✔ name.stoa
✔ same-names.stoa
✔ scope.stoa
✔ semantic-return.stoa
✔ sticky-precision.stoa
Passing: 14 Failing: 0

Testing the evaluator (with parse errors)
✔ arithmetic.stoa
✔ closures.stoa
✔ divide-by-zero.stoa
✔ fib.stoa
✔ functions.stoa
✔ global-redefine.stoa
✔ hello-world.stoa
✔ literals.stoa
✔ logical-ternary.stoa
✔ name.stoa
✔ same-names.stoa
✔ scope.stoa
✔ semantic-return.stoa
✔ sticky-precision.stoa
Passing: 14 Failing: 0

#+end_example


** Code Coverage

#+begin_src sh :exports both :results verbatim
make coverage
#+end_src

#+RESULTS:
#+begin_example
npx nyc --extends "@istanbuljs/nyc-config-typescript" \
	        --exclude-after-remap \
	        --reporter html --reporter text --reporter text-summary \
            make silent-test
------------------|---------|----------|---------|---------|----------------------------------------
File              | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
------------------|---------|----------|---------|---------|----------------------------------------
All files         |   87.59 |    69.94 |   94.11 |   88.29 |
 src              |   87.47 |    67.97 |   96.12 |   88.78 |
  ast.ts          |     100 |      100 |     100 |     100 |
  errors.ts       |     100 |      100 |     100 |     100 |
  interpreter.ts  |   81.52 |     67.3 |   96.42 |   84.25 | ...120-126,141,158,173-175,183,198-204
  parser.ts       |   85.13 |    64.56 |   96.87 |   86.32 | ...140,150-154,228,329-334,383,406-424
  printer.ts      |   91.52 |     62.5 |      96 |   90.38 | 44-50
  resolver.ts     |    96.2 |       90 |   96.42 |   98.55 | 91
  runtime.ts      |   95.45 |       50 |      80 |     100 | 21-22
  scanner.ts      |     100 |      100 |     100 |     100 |
  stoa.ts         |   86.48 |       75 |     100 |   86.11 | 18-19,31,45-46
 src/ast          |    97.7 |      100 |      95 |   96.87 |
  declarations.ts |     100 |      100 |     100 |     100 |
  expressions.ts  |     100 |      100 |     100 |     100 |
  statements.ts   |    92.3 |      100 |   85.71 |   89.47 | 25-26
  visitor.ts      |     100 |      100 |     100 |     100 |
 src/lib          |   81.33 |    69.86 |   85.71 |   82.03 |
  cli.ts          |     100 |      100 |     100 |     100 |
  parser.ts       |   84.37 |       60 |   81.81 |   80.76 | 10,27,52-53,62
  repl.ts         |     100 |      100 |     100 |     100 |
  reporter.ts     |      50 |        0 |       0 |   33.33 | 9-10
  tokenizer.ts    |   81.08 |       75 |   93.75 |   83.33 | 57-58,66-68,150-162,181-182
 src/runtime      |   91.42 |    79.41 |      90 |      88 |
  environment.ts  |   90.47 |       75 |     100 |   84.61 | 17,23
  globals.ts      |      75 |      100 |      50 |      75 | 7
  values.ts       |     100 |      100 |     100 |     100 |
------------------|---------|----------|---------|---------|----------------------------------------

=============================== Coverage summary ===============================
Statements   : 87.59% ( 770/879 )
Branches     : 69.94% ( 277/396 )
Functions    : 94.11% ( 176/187 )
Lines        : 88.29% ( 664/752 )
================================================================================
#+end_example

The latest uploaded report is at: https://khtdr.com/stoa/coverage/


** Potential Goals
- full stack from sql to hover effects
- lsp compatible
- actually use it to create
- minimize user function writing with string/date/number primitives

* ...
** clean
src_elisp[:results none]{(save-excursion (org-goto-line 1) (+org/remove-result-blocks t))}
** build
src_elisp[:results none]{(save-excursion (org-goto-line 1) (org-babel-execute-subtree))}
