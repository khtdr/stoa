* Project Stoa

** Project Status
*** [ ] create a malleable language framework for exploring language ideas

** Build Status
#+begin_src sh :exports both :results verbatim
make build
#+end_src

#+RESULTS:
: CLI Building entry: src/stoa.ts
: CLI Using tsconfig: tsconfig.json
: CLI tsup v6.1.2
: CLI Target: node14
: CJS Build start
: CJS ⚡️ Build success in 37ms
: CJS bin/stoa.js     48.76 KB
: CJS bin/stoa.js.map 104.03 KB

** Usage Documentation
#+begin_src sh :exports both :results verbatim
./bin/stoa --help
#+end_src

#+RESULTS:
#+begin_example
Usage: node ./bin/stoa.js [options] [file]
Show this help message
    --help
prints version info and exits
    -v, --version
prints parse tree and exits
    -p, --parse
prints tokens and exits
    -t, --tokens

#+end_example

** Current Version
#+begin_src sh :exports both :results verbatim
./bin/stoa -v
#+end_src

#+RESULTS:
: stoa-2022.07.29

** Code Coverage

#+begin_src sh :exports both :results verbatim
make coverage
#+end_src

#+RESULTS:
#+begin_example
------------------|---------|----------|---------|---------|----------------------------------------
File              | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
------------------|---------|----------|---------|---------|----------------------------------------
All files         |    88.9 |    71.15 |   93.96 |    89.5 |
 src              |   86.63 |    66.78 |   95.16 |   87.92 |
  ast.ts          |     100 |      100 |     100 |     100 |
  interpreter.ts  |   81.52 |     67.3 |   96.42 |   84.25 | ...126-132,147,164,179-181,189,204-210
  parser.ts       |   84.14 |    63.15 |   94.11 |   85.64 | ...149,159-163,237,338-343,392,415-433
  printer.ts      |   91.52 |     62.5 |      96 |   90.38 | 44-50
  resolver.ts     |   95.06 |       85 |   96.42 |   95.89 | 41,110,147
  runtime.ts      |   95.45 |       50 |      80 |     100 | 21-22
  scanner.ts      |     100 |      100 |     100 |     100 |
  stoa.ts         |      90 |    81.81 |     100 |   88.88 | 34-35
 src/ast          |    97.7 |      100 |      95 |   96.87 |
  declarations.ts |     100 |      100 |     100 |     100 |
  expressions.ts  |     100 |      100 |     100 |     100 |
  statements.ts   |    92.3 |      100 |   85.71 |   89.47 | 25-26
  visitor.ts      |     100 |      100 |     100 |     100 |
 src/lib          |   91.03 |    78.72 |   91.11 |   91.44 |
  language.ts     |      90 |    86.66 |     100 |    92.1 | 42-44
  parser.ts       |   82.85 |    52.63 |   76.92 |   79.31 | 10-13,30,55-56,69
  reporter.ts     |     100 |      100 |     100 |     100 |
  tokenizer.ts    |   92.03 |    84.48 |   94.44 |   92.78 | 61-62,70-72,195-196
 src/runtime      |   91.42 |    79.41 |      90 |      88 |
  environment.ts  |   90.47 |       75 |     100 |   84.61 | 17,23
  globals.ts      |      75 |      100 |      50 |      75 | 7
  values.ts       |     100 |      100 |     100 |     100 |
------------------|---------|----------|---------|---------|----------------------------------------

=============================== Coverage summary ===============================
Statements   : 88.9% ( 809/910 )
Branches     : 71.15% ( 296/416 )
Functions    : 93.96% ( 187/199 )
Lines        : 89.5% ( 699/781 )
================================================================================
#+end_example

The latest uploaded report is at: https://khtdr.com/stoa/coverage/

** Code Structure
#+begin_src shell :results none
make graph
#+end_src


[[./ddot.png]]

[[./archi.png]]

[[./dependency-graph.png]]


** Test Suite Status

#+begin_src sh :exports both :results verbatim
make test
#+end_src

#+RESULTS:
#+begin_example
Testing: arithmetic.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime output
Testing: closures.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime output
Testing: comments.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime output
Testing: divide-by-zero.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime output
Testing: fib.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime output
Testing: functions.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime output
Testing: global-redefine.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime output
Testing: hello-world.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime output
Testing: literals.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime output
Testing: logical-ternary.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime output
Testing: name.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime output
Testing: same-names.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime output
Testing: scope.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime output
Testing: semantic-return.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime output
Testing: sticky-precision.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime output
Passing: 90 Failing: 0

#+end_example


** Potential Goals
- full stack from sql to hover effects
- lsp compatible
- actually use it to create
- minimize user function writing with string/date/number primitives

* ...
** clean
src_elisp[:results none]{(save-excursion (org-goto-line 1) (+org/remove-result-blocks t))}
** build
src_elisp[:results none]{(save-excursion (org-goto-line 1) (org-babel-execute-subtree))}
