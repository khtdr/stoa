* Project Stoa

** Project Status
*** [ ] create a malleable language framework for exploring language ideas

** Build Status
#+begin_src sh :exports both :results verbatim
make build
#+end_src

#+RESULTS:
#+begin_example
pnpm install
Lockfile is up-to-date, resolution step is skipped
Already up-to-date

CLI Building entry: src/stoa.ts
CLI Using tsconfig: tsconfig.json
CLI tsup v6.1.2
CLI Target: node14
CJS Build start
CJS ⚡️ Build success in 156ms
CJS bin/stoa.js     47.07 KB
CJS bin/stoa.js.map 99.56 KB
#+end_example

** Usage Documentation
#+begin_src sh :exports both :results verbatim
./bin/stoa --help
#+end_src

#+RESULTS:
#+begin_example
Usage: node ./bin/stoa.js [options] [file]
Show this help message
    --help
prints version info and exits
    -v
prints parse tree and exits
    -p
prints tokens and exits
    -t

#+end_example

** Current Version
#+begin_src sh :exports both :results verbatim
./bin/stoa -v
#+end_src

#+RESULTS:
: stoa-2022.07.29

** Code Structure
#+begin_src shell :results none
make graph
#+end_src

[[./dependency-graph.png]]


** Test Suite Status

#+begin_src sh :exports both :results verbatim
make test
#+end_src

#+RESULTS:
#+begin_example
Running the test suite
Test: arithmetic.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime Output
Test: closures.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime Output
Test: comments.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime Output
Test: divide-by-zero.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime Output
Test: fib.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime Output
Test: functions.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime Output
Test: global-redefine.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime Output
Test: hello-world.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime Output
Test: literals.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime Output
Test: logical-ternary.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime Output
Test: name.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime Output
Test: same-names.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime Output
Test: scope.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime Output
Test: semantic-return.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime Output
Test: sticky-precision.stoa
  ✔ Token errors
  ✔ Token output
  ✔ Parse errors
  ✔ Parse tree
  ✔ Runtime errors
  ✔ Runtime Output
Passing: 90 Failing: 0

#+end_example


** Code Coverage

#+begin_src sh :exports both :results verbatim
make coverage
#+end_src

#+RESULTS:
#+begin_example
------------------|---------|----------|---------|---------|----------------------------------------
File              | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
------------------|---------|----------|---------|---------|----------------------------------------
All files         |   89.06 |    71.71 |   94.14 |   89.61 |
 src              |   87.68 |    68.32 |   96.15 |   89.01 |
  ast.ts          |     100 |      100 |     100 |     100 |
  errors.ts       |     100 |      100 |     100 |     100 |
  interpreter.ts  |   81.52 |     67.3 |   96.42 |   84.25 | ...120-126,141,158,173-175,183,198-204
  parser.ts       |   85.13 |    64.56 |   96.87 |   86.32 | ...140,150-154,228,329-334,383,406-424
  printer.ts      |   91.52 |     62.5 |      96 |   90.38 | 44-50
  resolver.ts     |    96.2 |       90 |   96.42 |   98.55 | 91
  runtime.ts      |   95.45 |       50 |      80 |     100 | 21-22
  scanner.ts      |     100 |      100 |     100 |     100 |
  stoa.ts         |   89.18 |    81.25 |     100 |   88.88 | 18-19,45-46
 src/ast          |    97.7 |      100 |      95 |   96.87 |
  declarations.ts |     100 |      100 |     100 |     100 |
  expressions.ts  |     100 |      100 |     100 |     100 |
  statements.ts   |    92.3 |      100 |   85.71 |   89.47 | 25-26
  visitor.ts      |     100 |      100 |     100 |     100 |
 src/lib          |   89.11 |    78.08 |   85.71 |    88.8 |
  parser.ts       |   84.37 |       60 |   81.81 |   80.76 | 10,27,52-53,62
  reporter.ts     |      50 |        0 |       0 |   33.33 | 9-10
  tokenizer.ts    |   91.89 |    85.71 |   93.75 |    92.7 | 57-58,66-68,183-184
 src/runtime      |   91.42 |    79.41 |      90 |      88 |
  environment.ts  |   90.47 |       75 |     100 |   84.61 | 17,23
  globals.ts      |      75 |      100 |      50 |      75 | 7
  values.ts       |     100 |      100 |     100 |     100 |
------------------|---------|----------|---------|---------|----------------------------------------

=============================== Coverage summary ===============================
Statements   : 89.06% ( 782/878 )
Branches     : 71.71% ( 284/396 )
Functions    : 94.14% ( 177/188 )
Lines        : 89.61% ( 673/751 )
================================================================================
#+end_example

The latest uploaded report is at: https://khtdr.com/stoa/coverage/


** Potential Goals
- full stack from sql to hover effects
- lsp compatible
- actually use it to create
- minimize user function writing with string/date/number primitives

* ...
** clean
src_elisp[:results none]{(save-excursion (org-goto-line 1) (+org/remove-result-blocks t))}
** build
src_elisp[:results none]{(save-excursion (org-goto-line 1) (org-babel-execute-subtree))}
